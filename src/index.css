@import "tailwindcss";

@theme {
  --color-gold: #ffd700;
  --color-danger: #dc2626;
  --color-cash: #4ade80;
  --color-fixed: #60a5fa;
  --color-goodwill: #c084fc;
  --color-liability: #f87171;
  --color-equity: #facc15;
  --color-equity-negative: #ef4444;
  --color-dark-bg: #0f172a;
  --color-dark-surface: #1e293b;
  --color-dark-border: #334155;
}

body {
  margin: 0;
  background: var(--color-dark-bg);
  color: #e2e8f0;
  font-family: 'Segoe UI', 'Hiragino Sans', 'Noto Sans JP', sans-serif;
  overflow-x: hidden;
}

* {
  box-sizing: border-box;
}

/* TV noise overlay */
.noise-overlay {
  position: absolute; inset: 0; z-index: 60;
  pointer-events: none; opacity: 0;
  mix-blend-mode: overlay;
  background: repeating-conic-gradient(rgba(255,255,255,0.03) 0%, rgba(0,0,0,0.06) 1%, transparent 2%);
  background-size: 3px 3px;
  animation: noise-flicker 0.15s steps(3) infinite;
}
.noise-overlay.active { opacity: 1; }
@keyframes noise-flicker { 0%{background-position:0 0} 33%{background-position:-5px 5px} 66%{background-position:3px -3px} 100%{background-position:-3px 0} }

/* Crack overlay */
.crack-overlay { position: absolute; inset: 0; pointer-events: none; z-index: 5; }
.crack-overlay svg { width: 100%; height: 100%; animation: crack-appear 0.6s ease-out forwards; }
@keyframes crack-appear { 0%{clip-path:inset(0 100% 0 0);opacity:0} 30%{opacity:1} 100%{clip-path:inset(0 0 0 0);opacity:1} }

/* CAUTION tape (GC warning) */
.caution-tape {
  position: absolute; inset: -6px; z-index: 40;
  pointer-events: none; border-radius: inherit;
  border: 4px solid transparent;
  background: repeating-linear-gradient(
    -45deg, #000 0px, #000 10px, #eab308 10px, #eab308 20px
  ) border-box;
  -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
  mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  animation: caution-scroll 0.8s linear infinite;
}
@keyframes caution-scroll { to { background-position: 28px 0; } }

/* Cash smoke evaporation effect */
.smoke-particle {
  position: absolute; top: 0; left: 50%;
  width: 6px; height: 6px; border-radius: 50%;
  background: rgba(255,255,255,0.3);
  pointer-events: none;
  animation: smoke-rise 1.5s ease-out infinite;
}
.smoke-particle:nth-child(2) { left: 30%; animation-delay: 0.4s; width: 4px; height: 4px; }
.smoke-particle:nth-child(3) { left: 70%; animation-delay: 0.8s; width: 5px; height: 5px; }
@keyframes smoke-rise {
  0%   { transform: translateY(0) scale(1); opacity: 0.4; }
  100% { transform: translateY(-20px) scale(2); opacity: 0; }
}

/* Vital pulse (heartbeat red glow) — z-index:35 */
.vital-pulse-overlay {
  position: absolute; inset: -8px; z-index: 35;
  pointer-events: none; border-radius: inherit;
  background: radial-gradient(ellipse at center,
    rgba(220,38,38,0.35) 0%, rgba(220,38,38,0.1) 50%, transparent 80%);
  opacity: 0;
  animation: vital-pulse 0.85s ease-in-out infinite;
}
@keyframes vital-pulse {
  0%   { opacity: 0; transform: scale(1); }
  15%  { opacity: 0.8; transform: scale(1.02); }
  30%  { opacity: 0.2; transform: scale(1); }
  45%  { opacity: 0.6; transform: scale(1.01); }
  60%  { opacity: 0.1; transform: scale(1); }
  100% { opacity: 0; transform: scale(1); }
}

/* Shatter particles (impairment) — z-index:30 */
.shatter-particle {
  position: absolute; width: 6px; height: 6px;
  border-radius: 1px; pointer-events: none; z-index: 30;
  animation: shatter-fly var(--duration, 1s) ease-out forwards;
}
@keyframes shatter-fly {
  0%   { transform: translate(0,0) rotate(0deg) scale(1); opacity: 0.9; }
  100% { transform: translate(var(--tx,30px), var(--ty,-40px)) rotate(var(--rot,180deg)) scale(0.2); opacity: 0; }
}

/* Sand-crumble particles (goodwill impairment) — z-index:30 */
.sand-particle {
  position: absolute; pointer-events: none; z-index: 30;
  width: var(--size, 3px); height: var(--size, 3px);
  border-radius: 50%;
  animation: sand-fall var(--duration, 1.2s) ease-in forwards;
  animation-delay: var(--delay, 0s);
}
@keyframes sand-fall {
  0%   { transform: translate(0, 0) rotate(0deg) scale(1); opacity: 0.9; }
  30%  { transform: translate(var(--drift, 5px), 10px) rotate(90deg) scale(0.9); opacity: 0.8; }
  70%  { transform: translate(var(--drift2, -3px), var(--fall, 40px)) rotate(200deg) scale(0.5); opacity: 0.5; }
  100% { transform: translate(var(--drift3, 2px), var(--fall2, 70px)) rotate(300deg) scale(0.1); opacity: 0; }
}

/* Glow particles (equity surge) — z-index:30 */
.glow-particle {
  position: absolute; width: 4px; height: 4px;
  border-radius: 50%; pointer-events: none; z-index: 30;
  background: radial-gradient(circle, #ffd700 0%, rgba(255,215,0,0.4) 60%, transparent 100%);
  box-shadow: 0 0 6px 2px rgba(255,215,0,0.5);
  animation: glow-rise var(--duration, 1.2s) ease-out forwards;
}
@keyframes glow-rise {
  0%   { transform: translateY(0) scale(1); opacity: 0.9; }
  50%  { transform: translateY(var(--ty, -30px)) scale(1.3); opacity: 0.7; }
  100% { transform: translateY(var(--ty2, -60px)) scale(0.5); opacity: 0; }
}

/* Stakeholder voice bubble — z-index:45 */
.voice-bubble {
  position: absolute; z-index: 45; pointer-events: none;
  max-width: 160px; padding: 4px 10px; border-radius: 8px;
  font-size: 11px; font-weight: 600; white-space: nowrap;
  backdrop-filter: blur(4px);
}
.voice-bubble--negative {
  background: rgba(220,38,38,0.25); color: #fca5a5;
  border: 1px solid rgba(248,113,113,0.3);
  text-shadow: 0 0 8px rgba(220,38,38,0.4);
}
.voice-bubble--positive {
  background: rgba(34,197,94,0.2); color: #86efac;
  border: 1px solid rgba(74,222,128,0.3);
  text-shadow: 0 0 8px rgba(34,197,94,0.3);
}

/* B/S prediction range sliders */
.bs-range {
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 8px;
  border-radius: 4px;
  background: rgba(100, 116, 139, 0.3);
  outline: none;
}
.bs-range::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: var(--thumb-color, #facc15);
  cursor: pointer;
  border: 2px solid rgba(255, 255, 255, 0.4);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
}
.bs-range::-moz-range-thumb {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: var(--thumb-color, #facc15);
  cursor: pointer;
  border: 2px solid rgba(255, 255, 255, 0.4);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
}
.bs-range::-webkit-slider-runnable-track {
  height: 8px;
  border-radius: 4px;
}
.bs-range::-moz-range-track {
  height: 8px;
  border-radius: 4px;
  background: rgba(100, 116, 139, 0.3);
}

/* Mobile slider enlargement */
@media (pointer: coarse) {
  .bs-range::-webkit-slider-thumb { width: 40px; height: 40px; }
  .bs-range::-moz-range-thumb { width: 40px; height: 40px; }
  .bs-range { height: 12px; }
  .bs-range::-webkit-slider-runnable-track { height: 12px; }
  .bs-range::-moz-range-track { height: 12px; }
}

/* GC Crisis Mode: red flashing border */
@keyframes gc-flash {
  0%, 100% { border-color: rgba(220, 38, 38, 0.8); box-shadow: 0 0 20px rgba(220, 38, 38, 0.4); }
  50% { border-color: rgba(220, 38, 38, 0.2); box-shadow: 0 0 5px rgba(220, 38, 38, 0.1); }
}
.gc-flash-border {
  border: 3px solid rgba(220, 38, 38, 0.8);
  animation: gc-flash 0.5s infinite;
  border-radius: inherit;
}

/* Skymark debt explosion */
@keyframes debt-explosion {
  0% { transform: scaleY(1); }
  40% { transform: scaleY(1.3); }
  100% { transform: scaleY(1); }
}
.debt-explosion {
  animation: debt-explosion 0.6s ease-out;
  transform-origin: bottom;
}

/* Evergrande B/S shatter */
@keyframes bs-explode {
  0% { transform: scale(1) rotate(0deg); opacity: 1; }
  60% { transform: scale(1.1) rotate(2deg); opacity: 0.8; }
  100% { transform: scale(0) rotate(15deg); opacity: 0; }
}
.bs-explode {
  animation: bs-explode 1.5s ease-in forwards;
}

/* NVIDIA AI circuit glow */
.ai-circuit-glow {
  position: relative;
}
.ai-circuit-glow::before {
  content: '';
  position: absolute;
  inset: -4px;
  z-index: -1;
  border-radius: inherit;
  opacity: var(--glow-intensity, 0);
  background:
    repeating-linear-gradient(0deg, transparent, transparent 8px, rgba(118, 255, 3, 0.04) 8px, rgba(118, 255, 3, 0.04) 9px),
    repeating-linear-gradient(90deg, transparent, transparent 8px, rgba(118, 255, 3, 0.04) 8px, rgba(118, 255, 3, 0.04) 9px);
  box-shadow: 0 0 calc(var(--glow-intensity, 0) * 30px) rgba(118, 255, 3, 0.3);
  transition: opacity 0.5s;
}

/* Screen shake */
@keyframes screen-shake {
  0%, 100% { transform: translate(0, 0); }
  10% { transform: translate(-3px, 2px); }
  20% { transform: translate(4px, -1px); }
  30% { transform: translate(-2px, 3px); }
  40% { transform: translate(3px, -2px); }
  50% { transform: translate(-4px, 1px); }
  60% { transform: translate(2px, -3px); }
  70% { transform: translate(-1px, 2px); }
  80% { transform: translate(3px, -1px); }
  90% { transform: translate(-2px, -2px); }
}
.screen-shake {
  animation: screen-shake 0.4s ease-out;
}

/* Tesla cash runway pulse */
@keyframes cash-runway-pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.7; transform: scale(1.05); }
}
.cash-runway-pulse {
  animation: cash-runway-pulse 0.8s ease-in-out infinite;
}

/* ===== 3D B/S column — extruded block with visible faces ===== */

/* Outer wrapper (no overflow:hidden) — holds pseudo-element faces */
.bs-col-3d {
  position: relative;
}

/* Right side face */
.bs-col-3d::after {
  content: '';
  position: absolute;
  top: 5px;
  left: 100%;
  width: 10px;
  height: 100%;
  background: linear-gradient(90deg, #64748b 0%, #475569 40%, #334155 100%);
  border-radius: 0 4px 4px 0;
  pointer-events: none;
}

/* Bottom face */
.bs-col-3d::before {
  content: '';
  position: absolute;
  top: 100%;
  left: 5px;
  width: 100%;
  height: 8px;
  background: linear-gradient(180deg, #475569 0%, #334155 60%, #1e293b 100%);
  border-radius: 0 0 4px 4px;
  pointer-events: none;
}

/* Inner column (has overflow:hidden for content) */
.bs-col-inner {
  position: relative;
  z-index: 1;
  border-top: 2px solid rgba(255,255,255,0.3);
  border-left: 1px solid rgba(255,255,255,0.12);
  box-shadow: 0 2px 10px rgba(0,0,0,0.4);
}

/* Individual block segments — beveled slab look */
.bs-col-inner > div {
  box-shadow:
    inset 5px 0 8px -3px rgba(255,255,255,0.12),
    inset -5px 0 8px -3px rgba(0,0,0,0.25),
    inset 0 2px 3px -1px rgba(255,255,255,0.1),
    inset 0 -2px 3px -1px rgba(0,0,0,0.2);
  border-bottom: 1px solid rgba(0,0,0,0.25);
}
.bs-col-inner > *:last-child {
  border-bottom: none;
}

/* ===== 3D Slider styling ===== */
.bs-range.bs-range-3d {
  background: linear-gradient(
    to right,
    rgba(0,0,0,0.25),
    rgba(100,116,139,0.45) 25%,
    rgba(100,116,139,0.35) 75%,
    rgba(0,0,0,0.15)
  );
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.5), inset 0 -1px 2px rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.06);
}
.bs-range.bs-range-3d::-webkit-slider-thumb {
  background: radial-gradient(circle at 35% 35%, rgba(255,255,255,0.5), var(--thumb-color, #facc15) 55%);
  box-shadow:
    0 2px 8px rgba(0,0,0,0.5),
    inset 0 1px 3px rgba(255,255,255,0.4),
    0 0 10px rgba(0,0,0,0.2);
  border: 2px solid rgba(255,255,255,0.5);
  width: 28px;
  height: 28px;
}
.bs-range.bs-range-3d::-moz-range-thumb {
  background: radial-gradient(circle at 35% 35%, rgba(255,255,255,0.5), var(--thumb-color, #facc15) 55%);
  box-shadow:
    0 2px 8px rgba(0,0,0,0.5),
    inset 0 1px 3px rgba(255,255,255,0.4),
    0 0 10px rgba(0,0,0,0.2);
  border: 2px solid rgba(255,255,255,0.5);
  width: 28px;
  height: 28px;
}

@media (pointer: coarse) {
  .bs-range.bs-range-3d::-webkit-slider-thumb { width: 40px; height: 40px; }
  .bs-range.bs-range-3d::-moz-range-thumb { width: 40px; height: 40px; }
}

/* ===== Prediction pulse (golden glow, no layout shift) ===== */
@keyframes prediction-pulse {
  0%, 100% {
    box-shadow: 0 0 0 2px rgba(250,204,21,0.25), 0 0 8px rgba(250,204,21,0.15);
  }
  50% {
    box-shadow: 0 0 0 3px rgba(250,204,21,0.7), 0 0 24px rgba(250,204,21,0.4), 0 0 48px rgba(250,204,21,0.1);
  }
}
.prediction-pulse {
  border-radius: 12px;
  animation: prediction-pulse 2s ease-in-out infinite;
}

/* ===== Prediction label blink ===== */
@keyframes prediction-label-blink {
  0%, 100% { opacity: 1; text-shadow: 0 0 12px rgba(250,204,21,0.6); }
  50% { opacity: 0.35; text-shadow: none; }
}
.prediction-label-blink {
  animation: prediction-label-blink 1.2s ease-in-out infinite;
}
